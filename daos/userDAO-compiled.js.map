{"version":3,"sources":["userDAO.js"],"names":[],"mappings":"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","file":"userDAO-compiled.js","sourcesContent":["/**\n * Created by liboyuan on 16/8/11.\n */\n\nvar mongoose = require('mongoose');\nvar formatter = require('../utils/formatter');\nmongoose.connect('mongodb://localhost/users');\n\nvar UserSchema = mongoose.Schema({\n    username: String,\n    password: String,\n    majorNumber: {type : Number, default: 2},\n    statistics: {\n        games: {\n            major: {type: Number, default: 0},\n            subMajor: {type: Number, default: 0},\n            slave: {type: Number, default: 0}\n        },\n        wins: {\n            major: {type: Number, default: 0},\n            subMajor: {type: Number, default: 0},\n            slave: {type: Number, default: 0}\n        },\n        levelUps: {\n            major: {type: Number, default: 0},\n            subMajor: {type: Number, default: 0},\n            slave: {type: Number, default: 0}\n        },\n        points: {\n            major: {type: Number, default: 0},\n            subMajor: {type: Number, default: 0},\n            slave: {type: Number, default: 0}\n        },\n        fohIn: {\n            major: {type: Number, default: 0},\n            subMajor: {type: Number, default: 0},\n            slave: {type: Number, default: 0}\n        },\n        fohOut: {\n            major: {type: Number, default: 0},\n            subMajor: {type: Number, default: 0},\n            slave: {type: Number, default: 0}\n        },\n        score: {type: Number, default: 0}\n    },\n    settings: {\n        soundtrack: {type : String, default: \"default\"}\n    }\n});\n\nUserSchema.methods.getStatistics = function () {\n    var ret = {};\n    var games = 0;\n    games += this.statistics.games.major;\n    games += this.statistics.games.subMajor;\n    games += this.statistics.games.slave;\n    var wins = 0;\n    wins += this.statistics.wins.major;\n    wins += this.statistics.wins.subMajor;\n    wins += this.statistics.wins.slave;\n    var levelUps = 0;\n    levelUps += this.statistics.levelUps.major;\n    levelUps += this.statistics.levelUps.subMajor;\n    levelUps += this.statistics.levelUps.slave;\n    var points = 0;\n    points += this.statistics.points.major;\n    points += this.statistics.points.subMajor;\n    points += this.statistics.points.slave;\n    var fohIn = 0;\n    fohIn += this.statistics.fohIn.major;\n    fohIn += this.statistics.fohIn.subMajor;\n    fohIn += this.statistics.fohIn.slave;\n    var fohOut = 0;\n    fohOut += this.statistics.fohOut.major;\n    fohOut += this.statistics.fohOut.subMajor;\n    fohOut += this.statistics.fohOut.slave;\n    ret.score = this.statistics.score;\n    ret.games = games;\n    ret.winRate = formatter.toPercentage(games != 0 ? wins / games : 0);\n    ret.levelUpsPerGame = formatter.toFloat(games != 0 ? levelUps / games : 0);\n    ret.pointsPerGame = formatter.toFloat(games != 0 ? points / games : 0);\n    ret.fohInPerGame = formatter.toFloat(games != 0 ? fohIn / games : 0);\n    ret.fohOutPerGame = formatter.toFloat(games != 0 ? fohOut / games : 0);\n    return ret;\n};\n\nvar User = mongoose.model('User', UserSchema);\n\nmodule.exports = User;"]}